<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Four Pillars Calculator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: #f5f5f5;
            min-height: 100vh;
            padding: 10px;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 2.2em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .input-section {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: nowrap;
        }
        
        .date-input {
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .date-input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .search-btn {
            padding: 12px 25px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        .search-btn:hover {
            transform: translateY(-2px);
        }
        
        .result-section {
            display: none;
            margin-top: 30px;
        }
        
        .saju-box {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .saju-title {
            font-size: 1.5em;
            margin-bottom: 15px;
            font-weight: bold;
        }
        
        .saju-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 2px;
            margin-bottom: 15px;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            padding: 8px;
            background: rgba(255, 255, 255, 0.1);
        }
        
        .grid-cell {
            background: rgba(255, 255, 255, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.4);
            border-radius: 6px;
            padding: 8px 4px;
            text-align: center;
            font-weight: bold;
            min-height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .label-cell {
            font-size: 0.8em;
            opacity: 0.9;
        }
        
        .stem-cell {
            font-size: 0.85em;
            color: white;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }
        
        .branch-cell {
            font-size: 0.85em;
            color: white;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }
        
        .wood { background-color: #228B22 !important; }
        .fire { background-color: #DC143C !important; }
        .earth { background-color: #DAA520 !important; }
        .metal { background-color: #C0C0C0 !important; color: #333 !important; }
        .water { background-color: #191970 !important; }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .info-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #667eea;
        }
        
        .info-title {
            color: #2c3e50;
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        
        .info-content {
            color: #555;
            line-height: 1.6;
        }
        
        .fortune-period {
            padding: 10px;
            margin: 5px 0;
            border-radius: 8px;
            border: 2px solid transparent;
        }
        
        .fortune-past {
            background-color: #f8f9fa;
            color: #6c757d;
            opacity: 0.7;
        }
        
        .fortune-current {
            background-color: #e3f2fd;
            border-color: #2196f3;
            color: #0d47a1;
            font-weight: bold;
        }
        
        .fortune-future {
            background-color: #f3e5f5;
            color: #7b1fa2;
        }
        
        .fortune-title {
            font-weight: bold;
            font-size: 0.9em;
        }
        
        .fortune-elements {
            display: flex;
            gap: 5px;
            margin-top: 5px;
            justify-content: center;
        }
        
        .fortune-element {
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.8em;
            color: white;
            text-shadow: 1px 1px 1px rgba(0,0,0,0.5);
        }
        
        .loading {
            text-align: center;
            color: #666;
            font-style: italic;
        }
        
        .error {
            background-color: #ffe6e6;
            color: #d8000c;
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
        }

        .inseong-section {
            margin-top: 20px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #667eea;
        }
        
        .period-selector {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .tab-container {
            display: flex;
            margin: 20px 0;
            border-bottom: 2px solid #eee;
            background: #f8f9fa;
            border-radius: 8px 8px 0 0;
            overflow: hidden;
        }
        
        .tab-btn {
            flex: 1;
            padding: 12px 15px;
            border: none;
            background: transparent;
            color: #666;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }
        
        .tab-btn:hover {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
        }
        
        .tab-btn.active {
            background: white;
            color: #667eea;
            border-bottom-color: #667eea;
            font-weight: bold;
        }
        
        .tab-content {
            display: none;
            padding: 20px 0;
            animation: fadeIn 0.3s ease-in-out;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @media (max-width: 768px) {
            .input-section {
                flex-direction: column;
                gap: 10px;
            }
            .date-input {
                width: 100%;
                max-width: 200px;
            }
            .tab-btn {
                font-size: 12px;
                padding: 10px 8px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üóìÔ∏è Four Pillars Calculator</h1>

        <div class="input-section">
            <select class="date-input" id="dayInput">
            </select>
            <select class="date-input" id="monthInput">
            </select>
            <select class="date-input" id="yearInput">
            </select>
            <select class="date-input" id="genderInput">
                <option value="">Gender</option>
                <option value="male">Male</option>
                <option value="female">Female</option>
            </select>
            <input type="time" class="date-input" id="timeInput" placeholder="Optional">
            <button class="search-btn" onclick="calculateSaju()">Calculate</button>
        </div>
        
        <div class="result-section" id="resultSection">
            <div class="saju-box">
                <div class="saju-title">Four Pillars</div>
                <div class="saju-grid">
                    <div class="grid-cell label-cell">Hour</div>
                    <div class="grid-cell label-cell">Day</div>
                    <div class="grid-cell label-cell">Month</div>
                    <div class="grid-cell label-cell">Year</div>
                    
                    <div class="grid-cell stem-cell" id="hourStem">-</div>
                    <div class="grid-cell stem-cell" id="dayStem">-</div>
                    <div class="grid-cell stem-cell" id="monthStem">-</div>
                    <div class="grid-cell stem-cell" id="yearStem">-</div>
                    
                    <div class="grid-cell branch-cell" id="hourBranch">-</div>
                    <div class="grid-cell branch-cell" id="dayBranch">-</div>
                    <div class="grid-cell branch-cell" id="monthBranch">-</div>
                    <div class="grid-cell branch-cell" id="yearBranch">-</div>
                </div>
                <div id="selectedDate" style="font-size: 1.1em; opacity: 0.9;"></div>
            </div>
            
            <div class="info-grid">
                <div class="info-card" id="fortuneCard" style="display: none;">
                    <div class="info-title">üîÆ Great Fortune</div>
                    <div class="info-content" id="fortuneInfo"></div>
                </div>
                
                <div class="info-card" id="yearlyCard">
                    <div class="info-title">üìä Yearly Fortune</div>
                    <div class="info-content" id="yearlyInfo"></div>
                </div>
            </div>

            <div class="inseong-section" id="inseongSection" style="display: none;">
                <div class="info-title">üìà Fortune Analysis</div>
                <div class="period-selector">
                    <label>Analysis Period:</label>
                    <input type="number" class="date-input" id="graphStartYear" placeholder="Start Year" value="2024" style="width: 120px;">
                    <input type="number" class="date-input" id="graphEndYear" placeholder="End Year" value="2028" style="width: 120px;">
                </div>
                
                <div class="tab-container">
                    <button class="tab-btn active" onclick="switchTab('study')">üìö Study</button>
                    <button class="tab-btn" onclick="switchTab('wealth')">üí∞ Wealth</button>
                    <button class="tab-btn" onclick="switchTab('career')">üè¢ Career</button>
                    <button class="tab-btn" onclick="switchTab('love')">üíï Love</button>
                </div>
                
                <div class="tab-content active" id="studyTab">
                    <button class="search-btn" onclick="showInseongFortune()">Generate Study Fortune Graph</button>
                    <canvas id="fortuneChart" style="display:none; height: 400px;"></canvas>
                </div>
                
                <div class="tab-content" id="wealthTab">
                    <button class="search-btn" onclick="showWealthFortune()">Generate Wealth Fortune Graph</button>
                    <canvas id="wealthChart" style="display:none; height: 400px;"></canvas>
                </div>
                
                <div class="tab-content" id="careerTab">
                    <button class="search-btn" onclick="showCareerFortune()">Generate Career Fortune Graph</button>
                    <canvas id="careerChart" style="display:none; height: 400px;"></canvas>
                </div>
                
                <div class="tab-content" id="loveTab">
                    <button class="search-btn" onclick="showLoveFortune()">Generate Love Fortune Graph</button>
                    <canvas id="loveChart" style="display:none; height: 400px;"></canvas>
                </div>
            </div>
        </div>
    </div>

    <script>
        const tianGanEn = ['Yang Wood', 'Yin Wood', 'Yang Fire', 'Yin Fire', 'Yang Earth', 'Yin Earth', 'Yang Metal', 'Yin Metal', 'Yang Water', 'Yin Water'];
        const diZhiEn = ['Rat', 'Ox', 'Tiger', 'Rabbit', 'Dragon', 'Snake', 'Horse', 'Goat', 'Monkey', 'Rooster', 'Dog', 'Pig'];
        
        const elementClass = { 'Wood': 'wood', 'Fire': 'fire', 'Earth': 'earth', 'Metal': 'metal', 'Water': 'water' };
        
        const wuxing = {
            'Yang Wood': 'Wood', 'Yin Wood': 'Wood', 'Yang Fire': 'Fire', 'Yin Fire': 'Fire', 'Yang Earth': 'Earth',
            'Yin Earth': 'Earth', 'Yang Metal': 'Metal', 'Yin Metal': 'Metal', 'Yang Water': 'Water', 'Yin Water': 'Water',
            'Rat': 'Water', 'Ox': 'Earth', 'Tiger': 'Wood', 'Rabbit': 'Wood', 'Dragon': 'Earth',
            'Snake': 'Fire', 'Horse': 'Fire', 'Goat': 'Earth', 'Monkey': 'Metal', 'Rooster': 'Metal', 'Dog': 'Earth', 'Pig': 'Water'
        };

        const unsungScores = {
            'Ïû•ÏÉù': 40, 'Î™©Ïöï': 10, 'Í¥ÄÎåÄ': 30, 'Í±¥Î°ù': 60,
            'Ï†úÏôï': 70, 'Ïá†': 50, 'Î≥ë': 30, 'ÏÇ¨': 10,
            'Î¨ò': -20, 'Ï†à': -40, 'ÌÉú': -20, 'Ïñë': 0
        };

        const jangSaengPos = {
            'Yang Wood': 'Pig', 'Yin Wood': 'Horse', 'Yang Fire': 'Tiger', 'Yin Fire': 'Rooster',
            'Yang Earth': 'Tiger', 'Yin Earth': 'Rooster', 'Yang Metal': 'Snake', 'Yin Metal': 'Rat',
            'Yang Water': 'Monkey', 'Yin Water': 'Rabbit'
        };

        const unsungOrder = ['Ïû•ÏÉù', 'Î™©Ïöï', 'Í¥ÄÎåÄ', 'Í±¥Î°ù', 'Ï†úÏôï', 'Ïá†', 'Î≥ë', 'ÏÇ¨', 'Î¨ò', 'Ï†à', 'ÌÉú', 'Ïñë'];
        const jiOrder = ['Rat', 'Ox', 'Tiger', 'Rabbit', 'Dragon', 'Snake', 'Horse', 'Goat', 'Monkey', 'Rooster', 'Dog', 'Pig'];
        
        let solarTermsData = null;
        
        const sipsinMapping = {
            'Yang Wood': { jeongin: 'Yin Water', pyeongin: 'Yang Water', jeongjae: 'Yin Earth', pyeonjae: 'Yang Earth', jeonggwan: 'Yin Metal', pyeonggwan: 'Yang Metal' },
            'Yin Wood': { jeongin: 'Yang Water', pyeongin: 'Yin Water', jeongjae: 'Yang Earth', pyeonjae: 'Yin Earth', jeonggwan: 'Yang Metal', pyeonggwan: 'Yin Metal' },
            'Yang Fire': { jeongin: 'Yin Wood', pyeongin: 'Yang Wood', jeongjae: 'Yin Metal', pyeonjae: 'Yang Metal', jeonggwan: 'Yin Water', pyeonggwan: 'Yang Water' },
            'Yin Fire': { jeongin: 'Yang Wood', pyeongin: 'Yin Wood', jeongjae: 'Yang Metal', pyeonjae: 'Yin Metal', jeonggwan: 'Yang Water', pyeonggwan: 'Yin Water' },
            'Yang Earth': { jeongin: 'Yin Fire', pyeongin: 'Yang Fire', jeongjae: 'Yin Water', pyeonjae: 'Yang Water', jeonggwan: 'Yin Wood', pyeonggwan: 'Yang Wood' },
            'Yin Earth': { jeongin: 'Yang Fire', pyeongin: 'Yin Fire', jeongjae: 'Yang Water', pyeonjae: 'Yin Water', jeonggwan: 'Yang Wood', pyeonggwan: 'Yin Wood' },
            'Yang Metal': { jeongin: 'Yin Earth', pyeongin: 'Yang Earth', jeongjae: 'Yin Wood', pyeonjae: 'Yang Wood', jeonggwan: 'Yin Fire', pyeonggwan: 'Yang Fire' },
            'Yin Metal': { jeongin: 'Yang Earth', pyeongin: 'Yin Earth', jeongjae: 'Yang Wood', pyeonjae: 'Yin Wood', jeonggwan: 'Yang Fire', pyeonggwan: 'Yin Fire' },
            'Yang Water': { jeongin: 'Yin Metal', pyeongin: 'Yang Metal', jeongjae: 'Yin Fire', pyeonjae: 'Yang Fire', jeonggwan: 'Yin Earth', pyeonggwan: 'Yang Earth' },
            'Yin Water': { jeongin: 'Yang Metal', pyeongin: 'Yin Metal', jeongjae: 'Yang Fire', pyeonjae: 'Yin Fire', jeonggwan: 'Yang Earth', pyeonggwan: 'Yin Earth' }
        };

        async function loadSolarTermsData() {
            try {
                const response = await fetch('solar_terms.json');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                solarTermsData = await response.json();
                console.log('Ï†àÏûÖÏãúÍ∞Ñ Îç∞Ïù¥ÌÑ∞ Î°úÎìú ÏôÑÎ£å');
                return true;
            } catch (error) {
                console.error('Ï†àÏûÖÏãúÍ∞Ñ Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ïã§Ìå®:', error);
                solarTermsData = null;
                return false;
            }
        }

        function getSolarMonth(date) {
            const year = date.getFullYear();
            const transitions = solarTermsData[year] || [];
            
            // Ìï¥Îãπ ÎÖÑÎèÑÏùò Ï†àÏûÖÏãúÍ∞Ñ Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏúºÎ©¥ null Î∞òÌôò
            if (transitions.length === 0) {
                return null;
            }
            
            // Before first transition (February), it's Month 12 of previous year
            const firstTransition = new Date(year, transitions[0].month - 1, transitions[0].day, transitions[0].hour, transitions[0].minute);
            if (date < firstTransition) {
                return 12;
            }
            
            // Check each transition
            for (let i = transitions.length - 1; i >= 0; i--) {
                const trans = transitions[i];
                const transDate = new Date(year, trans.month - 1, trans.day, trans.hour, trans.minute);
                if (date >= transDate) {
                    return i + 1;
                }
            }
            
            return null;
        }
        
        function getMonthStartDate(year, monthNum) {
            const transitions = solarTermsData[year];
            if (!transitions || monthNum < 1 || monthNum > 12) return null;
            
            if (monthNum === 12) {
                // Month 12 starts in previous year's December
                const prevTransitions = solarTermsData[year - 1];
                if (prevTransitions && prevTransitions.length >= 11) {
                    const trans = prevTransitions[10];
                    return new Date(year - 1, trans.month - 1, trans.day, trans.hour, trans.minute);
                }
            } else if (monthNum <= transitions.length) {
                const trans = transitions[monthNum - 1];
                return new Date(year, trans.month - 1, trans.day, trans.hour, trans.minute);
            }
            
            return null;
        }

        function normalizeIndex(index, mod) {
            return ((index % mod) + mod) % mod;
        }

        function isReverse(gan) {
            const reverseGans = ['Yin Wood', 'Yin Fire', 'Yin Earth', 'Yin Metal', 'Yin Water'];
            return reverseGans.includes(gan);
        }

        function calculateSipsinUnsung(ilgan, ganzhi, sipsinType) {
            const sipsin = sipsinMapping[ilgan];
            if (!sipsin || !sipsin[sipsinType]) return 0;
            
            const targetGan = sipsin[sipsinType];
            
            let ji = '';
            for (let animal of diZhiEn) {
                if (ganzhi.includes(animal)) {
                    ji = animal;
                    break;
                }
            }
            
            const jangSaeng = jangSaengPos[targetGan];
            if (!jangSaeng || !ji) return 0;
            
            const jangSaengIndex = jiOrder.indexOf(jangSaeng);
            const jiIndex = jiOrder.indexOf(ji);
            if (jangSaengIndex === -1 || jiIndex === -1) return 0;
            
            let diff = (jiIndex - jangSaengIndex + 12) % 12;
            if (isReverse(targetGan)) {
                diff = (12 - diff) % 12;
            }
            
            const unsung = unsungOrder[diff];
            const score = unsungScores[unsung] || 0;
            
            return score;
        }

        function calculateInseongUnsung(ilgan, ganzhi) {
            return calculateSipsinUnsung(ilgan, ganzhi, 'jeongin');
        }

        function switchTab(tabName) {
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName + 'Tab').classList.add('active');
        }

        function showInseongFortune() {
            if (!window.currentPillars) {
                alert('Please calculate Four Pillars first.');
                return;
            }
            
            const startYear = parseInt(document.getElementById('graphStartYear').value);
            const endYear = parseInt(document.getElementById('graphEndYear').value);
            
            if (!startYear || !endYear || startYear >= endYear) {
                alert('Please enter a valid period.');
                return;
            }
            
            const ilgan = window.currentPillars.day;
            const yearMonthData = generateYearMonthGanzhi(startYear, endYear);
            const yearWeight = 0.7;
            const monthWeight = 0.3;
            
            const scores = [];
            const labels = [];
            
            yearMonthData.forEach(data => {
                const yearScore = calculateInseongUnsung(ilgan, data.yearGanzhi);
                const monthScore = calculateInseongUnsung(ilgan, data.monthGanzhi);
                
                const totalScore = yearScore * yearWeight + monthScore * monthWeight;
                scores.push(Math.round((totalScore + 100) * 10) / 10);
                labels.push(`${data.year}.${data.month.toString().padStart(2, '0')}`);
            });
            
            drawGraph(labels, scores, 'fortuneChart', 'Study Fortune Analysis');
        }

        function showWealthFortune() {
            if (!window.currentPillars) {
                alert('Please calculate Four Pillars first.');
                return;
            }
            
            const startYear = parseInt(document.getElementById('graphStartYear').value);
            const endYear = parseInt(document.getElementById('graphEndYear').value);
            
            if (!startYear || !endYear || startYear >= endYear) {
                alert('Please enter a valid period.');
                return;
            }
            
            const ilgan = window.currentPillars.day;
            const yearMonthData = generateYearMonthGanzhi(startYear, endYear);
            const yearWeight = 0.7;
            const monthWeight = 0.3;
            
            const scores = [];
            const labels = [];
            
            yearMonthData.forEach(data => {
                const jeongjaeYearScore = calculateSipsinUnsung(ilgan, data.yearGanzhi, 'jeongjae');
                const pyeonjaeYearScore = calculateSipsinUnsung(ilgan, data.yearGanzhi, 'pyeonjae');
                const jeongjaeMonthScore = calculateSipsinUnsung(ilgan, data.monthGanzhi, 'jeongjae');
                const pyeonjaeMonthScore = calculateSipsinUnsung(ilgan, data.monthGanzhi, 'pyeonjae');
                
                const yearScore = jeongjaeYearScore + pyeonjaeYearScore;
                const monthScore = jeongjaeMonthScore + pyeonjaeMonthScore;
                
                const totalScore = yearScore * yearWeight + monthScore * monthWeight;
                scores.push(Math.round((totalScore + 100) * 10) / 10);
                labels.push(`${data.year}.${data.month.toString().padStart(2, '0')}`);
            });
            
            drawGraph(labels, scores, 'wealthChart', 'Wealth Fortune Analysis');
        }

        function showCareerFortune() {
            if (!window.currentPillars) {
                alert('Please calculate Four Pillars first.');
                return;
            }
            
            const startYear = parseInt(document.getElementById('graphStartYear').value);
            const endYear = parseInt(document.getElementById('graphEndYear').value);
            
            if (!startYear || !endYear || startYear >= endYear) {
                alert('Please enter a valid period.');
                return;
            }
            
            const ilgan = window.currentPillars.day;
            const yearMonthData = generateYearMonthGanzhi(startYear, endYear);
            const yearWeight = 0.7;
            const monthWeight = 0.3;
            
            const scores = [];
            const labels = [];
            
            yearMonthData.forEach(data => {
                // Ï†ïÍ¥Ä + Ìé∏Í¥Ä Ìï©ÏÇ∞
                const jeonggwanYearScore = calculateSipsinUnsung(ilgan, data.yearGanzhi, 'jeonggwan');
                const pyeonggwanYearScore = calculateSipsinUnsung(ilgan, data.yearGanzhi, 'pyeonggwan');
                const jeonggwanMonthScore = calculateSipsinUnsung(ilgan, data.monthGanzhi, 'jeonggwan');
                const pyeonggwanMonthScore = calculateSipsinUnsung(ilgan, data.monthGanzhi, 'pyeonggwan');
                
                const yearScore = jeonggwanYearScore + pyeonggwanYearScore;
                const monthScore = jeonggwanMonthScore + pyeonggwanMonthScore;
                
                const totalScore = yearScore * yearWeight + monthScore * monthWeight;
                scores.push(Math.round((totalScore + 100) * 10) / 10);
                labels.push(`${data.year}.${data.month.toString().padStart(2, '0')}`);
            });
            
            drawGraph(labels, scores, 'careerChart', 'Career Fortune Analysis');
        }

        function showLoveFortune() {
            if (!window.currentPillars) {
                alert('Please calculate Four Pillars first.');
                return;
            }
            
            const genderInput = document.getElementById('genderInput').value;
            if (!genderInput) {
                alert('Please select gender for love fortune analysis.');
                return;
            }
            
            const startYear = parseInt(document.getElementById('graphStartYear').value);
            const endYear = parseInt(document.getElementById('graphEndYear').value);
            
            if (!startYear || !endYear || startYear >= endYear) {
                alert('Please enter a valid period.');
                return;
            }
            
            const ilgan = window.currentPillars.day;
            const yearMonthData = generateYearMonthGanzhi(startYear, endYear);
            const yearWeight = 0.7;
            const monthWeight = 0.3;
            
            const scores = [];
            const labels = [];
            
            const targetSipsin = genderInput === 'male' ? 'jeongjae' : 'jeonggwan';
            
            yearMonthData.forEach(data => {
                const yearScore = calculateSipsinUnsung(ilgan, data.yearGanzhi, targetSipsin);
                const monthScore = calculateSipsinUnsung(ilgan, data.monthGanzhi, targetSipsin);
                
                const totalScore = yearScore * yearWeight + monthScore * monthWeight;
                scores.push(Math.round((totalScore + 100) * 10) / 10);
                labels.push(`${data.year}.${data.month.toString().padStart(2, '0')}`);
            });
            
            drawGraph(labels, scores, 'loveChart', 'Love Fortune Analysis');
        }

        function drawGraph(labels, scores, canvasId, title) {
            const canvas = document.getElementById(canvasId);
            const ctx = canvas.getContext('2d');
            
            canvas.style.display = 'block';
            
            // Î∞òÏùëÌòï ÌÅ¨Í∏∞ ÏÑ§Ï†ï
            const container = canvas.parentElement;
            const containerWidth = container.offsetWidth - 40; // Ïó¨Î∞± Í≥†Î†§
            const isMobile = window.innerWidth <= 768;
            
            canvas.width = isMobile ? Math.min(containerWidth, 350) : 800;
            canvas.height = isMobile ? 300 : 400;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            const padding = isMobile ? 50 : 80;
            const graphWidth = canvas.width - padding * 2;
            const graphHeight = canvas.height - padding * 2;
            
            const minScore = Math.min(...scores);
            const maxScore = Math.max(...scores);
            const scoreRange = Math.max(maxScore - minScore, 10);
            
            ctx.fillStyle = '#f8f9fa';
            ctx.fillRect(padding, padding, graphWidth, graphHeight);
            
            ctx.strokeStyle = '#e0e0e0';
            ctx.lineWidth = 1;
            
            for (let i = 0; i <= 10; i++) {
                const x = padding + (i / 10) * graphWidth;
                ctx.beginPath();
                ctx.moveTo(x, padding);
                ctx.lineTo(x, padding + graphHeight);
                ctx.stroke();
            }
            
            for (let i = 0; i <= 10; i++) {
                const y = padding + (i / 10) * graphHeight;
                ctx.beginPath();
                ctx.moveTo(padding, y);
                ctx.lineTo(padding + graphWidth, y);
                ctx.stroke();
            }
            
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(padding, padding);
            ctx.lineTo(padding, padding + graphHeight);
            ctx.lineTo(padding + graphWidth, padding + graphHeight);
            ctx.stroke();
            
            const baselineY = padding + graphHeight - ((100 - minScore) / scoreRange) * graphHeight;
            if (baselineY >= padding && baselineY <= padding + graphHeight) {
                ctx.strokeStyle = '#ff6b6b';
                ctx.lineWidth = 2;
                ctx.setLineDash([10, 5]);
                ctx.beginPath();
                ctx.moveTo(padding, baselineY);
                ctx.lineTo(padding + graphWidth, baselineY);
                ctx.stroke();
                ctx.setLineDash([]);
                
                ctx.fillStyle = '#ff6b6b';
                ctx.font = `bold ${isMobile ? '10px' : '12px'} Arial`;
                ctx.textAlign = 'right';
                ctx.fillText('100', padding - 5, baselineY + 4);
            }
            
            if (scores.length > 1) {
                ctx.strokeStyle = '#667eea';
                ctx.lineWidth = 3;
                ctx.beginPath();
                
                let x = padding + (0 / (scores.length - 1)) * graphWidth;
                let y = padding + graphHeight - ((scores[0] - minScore) / scoreRange) * graphHeight;
                ctx.moveTo(x, y);
                
                for (let i = 1; i < scores.length; i++) {
                    const currentX = padding + (i / (scores.length - 1)) * graphWidth;
                    const currentY = padding + graphHeight - ((scores[i] - minScore) / scoreRange) * graphHeight;
                    ctx.lineTo(currentX, currentY);
                }
                ctx.stroke();
                
                ctx.fillStyle = '#667eea';
                scores.forEach((score, index) => {
                    const pointX = padding + (index / (scores.length - 1)) * graphWidth;
                    const pointY = padding + graphHeight - ((score - minScore) / scoreRange) * graphHeight;
                    
                    ctx.beginPath();
                    ctx.arc(pointX, pointY, isMobile ? 3 : 4, 0, 2 * Math.PI);
                    ctx.fill();
                });
            }
            
            ctx.fillStyle = '#333';
            ctx.font = `${isMobile ? '10px' : '12px'} Arial`;
            ctx.textAlign = 'center';
            
            const startYear = parseInt(document.getElementById('graphStartYear').value);
            const endYear = parseInt(document.getElementById('graphEndYear').value);
            const yearRange = endYear - startYear;
            
            const yearStep = isMobile ? Math.max(1, Math.floor(yearRange / 3)) : 1;
            for (let i = 0; i <= yearRange; i += yearStep) {
                const year = startYear + i;
                const x = padding + (i / yearRange) * graphWidth;
                ctx.fillText(year.toString(), x, canvas.height - padding + (isMobile ? 20 : 25));
            }
            
            ctx.textAlign = 'right';
            ctx.fillStyle = '#333';
            ctx.font = `${isMobile ? '10px' : '12px'} Arial`;
            
            for (let i = 0; i <= 5; i++) {
                const score = minScore + (scoreRange * i / 5);
                const y = padding + graphHeight - (i / 5) * graphHeight;
                ctx.fillText(score.toFixed(0), padding - 5, y + 4);
            }
            
            ctx.fillStyle = '#2c3e50';
            ctx.font = `bold ${isMobile ? '14px' : '18px'} Arial`;
            ctx.textAlign = 'center';
            ctx.fillText(title, canvas.width / 2, isMobile ? 25 : 30);
        }

        function generateYearMonthGanzhi(startYear, endYear) {
            const result = [];
            
            for (let year = startYear; year <= endYear; year++) {
                const baseYearGan = 1;
                const baseYearZhi = 5;
                const yearOffset = year - 2025;
                const yearGan = normalizeIndex(baseYearGan + yearOffset, 10);
                const yearZhi = normalizeIndex(baseYearZhi + yearOffset, 12);
                const yearGanzhi = tianGanEn[yearGan] + diZhiEn[yearZhi];
                
                for (let month = 1; month <= 12; month++) {
                    const yearGanMod5 = yearGan % 5;
                    let monthGanBase;
                    switch(yearGanMod5) {
                        case 0: case 5: monthGanBase = 2; break;
                        case 1: case 6: monthGanBase = 4; break;
                        case 2: case 7: monthGanBase = 6; break;
                        case 3: case 8: monthGanBase = 8; break;
                        case 4: case 9: monthGanBase = 0; break;
                    }
                    
                    const monthGan = normalizeIndex(monthGanBase + (month - 1), 10);
                    const monthZhi = normalizeIndex(2 + (month - 1), 12);
                    const monthGanzhi = tianGanEn[monthGan] + diZhiEn[monthZhi];
                    
                    result.push({
                        year: year,
                        month: month,
                        yearGanzhi: yearGanzhi,
                        monthGanzhi: monthGanzhi
                    });
                }
            }
            
            return result;
        }

        function calculateSaju() {
            const dayInput = document.getElementById('dayInput').value;
            const monthInput = document.getElementById('monthInput').value;
            const yearInput = document.getElementById('yearInput').value;
            const genderInput = document.getElementById('genderInput').value;
            const timeInput = document.getElementById('timeInput').value;
            
            if (!dayInput || !monthInput || !yearInput) {
                alert('Please select all date fields.');
                return;
            }
            
            // Ï†àÏûÖÏãúÍ∞Ñ Îç∞Ïù¥ÌÑ∞ ÌïÑÏàò Ï≤¥ÌÅ¨
            if (!solarTermsData) {
                alert('‚ùå Ï†àÏûÖÏãúÍ∞Ñ Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§!\n\nÏ†ïÌôïÌïú ÎßåÏÑ∏Î†• Í≥ÑÏÇ∞Ïù¥ Î∂àÍ∞ÄÎä•Ìï©ÎãàÎã§.\n\nÌï¥Í≤∞Î∞©Î≤ï:\n1. solar_terms.json ÌååÏùºÏù¥ index.htmlÍ≥º Í∞ôÏùÄ Ìè¥ÎçîÏóê ÏûàÎäîÏßÄ ÌôïÏù∏\n2. ÏõπÏÑúÎ≤ÑÎ•º ÌÜµÌï¥ Ï†ëÍ∑º (file:// ÌîÑÎ°úÌÜ†ÏΩú Î¨∏Ï†úÏùº Ïàò ÏûàÏùå)\n3. Î∏åÎùºÏö∞Ï†Ä Í∞úÎ∞úÏûêÎèÑÍµ¨ ÏΩòÏÜîÏóêÏÑú Ïò§Î•ò ÌôïÏù∏');
                return;
            }
            
            const year = parseInt(yearInput);
            
            // Ìï¥Îãπ Ïó∞ÎèÑ Ï†àÏûÖÏãúÍ∞Ñ Îç∞Ïù¥ÌÑ∞ Ï≤¥ÌÅ¨
            if (!solarTermsData[year]) {
                alert(`‚ùå ${year}ÎÖÑÎèÑ Ï†àÏûÖÏãúÍ∞Ñ Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§!\n\nÌòÑÏû¨ Î°úÎìúÎêú Ïó∞ÎèÑ: ${Object.keys(solarTermsData).join(', ')}\n\nÌï¥Îãπ Ïó∞ÎèÑÏùò Ï†àÏûÖÏãúÍ∞Ñ Ï†ïÎ≥¥Í∞Ä ÌïÑÏöîÌï©ÎãàÎã§.`);
                return;
            }
            
            console.log(`${year}ÎÖÑÎèÑ Ï†àÏûÖÏãúÍ∞Ñ Îç∞Ïù¥ÌÑ∞ ÌôïÏù∏Îê®`);
            
            const timeValue = timeInput || '12:00';
            const selectedDate = new Date(`${yearInput}-${monthInput.padStart(2, '0')}-${dayInput.padStart(2, '0')}T${timeValue}`);
            const month = selectedDate.getMonth() + 1;
            const day = selectedDate.getDate();
            const hour = selectedDate.getHours();
            
            let adjustedDate = new Date(year, month - 1, day);
            if (hour === 23) {
                adjustedDate = new Date(year, month - 1, day + 1);
            }
            
            const baseDate = new Date(2025, 5, 9);
            const daysDiff = Math.floor((adjustedDate - baseDate) / (1000 * 60 * 60 * 24));
            
            const baseDayGan = 5;
            const baseDayZhi = 9;
            
            const dayGan = normalizeIndex(baseDayGan + daysDiff, 10);
            const dayZhi = normalizeIndex(baseDayZhi + daysDiff, 12);
            
            const baseYearGan = 1;
            const baseYearZhi = 5;
            
            let solarYear = year;
            const lichunDate = getMonthStartDate(year, 1);
            if (lichunDate && selectedDate < lichunDate) {
                solarYear = year - 1;
            }
            
            const yearOffset = solarYear - 2025;
            const yearGan = normalizeIndex(baseYearGan + yearOffset, 10);
            const yearZhi = normalizeIndex(baseYearZhi + yearOffset, 12);
            
            const monthNumber = getSolarMonth(selectedDate);
            if (monthNumber === null) {
                alert(`‚ùå ${year}ÎÖÑ ${month}Ïõî ${day}ÏùºÏùò Ï†àÏûÖÏãúÍ∞Ñ Í≥ÑÏÇ∞Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§!\n\nÏ†ïÌôïÌïú ÏõîÏ£º Í≥ÑÏÇ∞Ïù¥ Î∂àÍ∞ÄÎä•Ìï©ÎãàÎã§.`);
                return;
            }
            
            const yearGanMod5 = yearGan % 5;
            let monthGanBase;
            switch(yearGanMod5) {
                case 0: case 5: monthGanBase = 2; break;
                case 1: case 6: monthGanBase = 4; break;
                case 2: case 7: monthGanBase = 6; break;
                case 3: case 8: monthGanBase = 8; break;
                case 4: case 9: monthGanBase = 0; break;
            }
            
            const monthGan = normalizeIndex(monthGanBase + (monthNumber - 1), 10);
            const monthZhi = normalizeIndex(2 + (monthNumber - 1), 12);
            
            let hourGan = null, hourZhi = null;
            if (timeInput) {
                let hourIndex = Math.floor((hour + 1) / 2) % 12;
                if (hour === 23) hourIndex = 0;
                
                const hourGanBase = (dayGan % 5) * 2;
                hourGan = normalizeIndex(hourGanBase + hourIndex, 10);
                hourZhi = hourIndex;
            }
            
            const yearStemText = tianGanEn[yearGan];
            const yearBranchText = diZhiEn[yearZhi];
            const monthStemText = tianGanEn[monthGan];
            const monthBranchText = diZhiEn[monthZhi];
            const dayStemText = tianGanEn[dayGan];
            const dayBranchText = diZhiEn[dayZhi];
            
            let hourStemText = '', hourBranchText = '';
            if (timeInput && hourGan !== null && hourZhi !== null) {
                hourStemText = tianGanEn[hourGan];
                hourBranchText = diZhiEn[hourZhi];
            }
            
            updateCell('yearStem', yearStemText, 'stem-cell');
            updateCell('monthStem', monthStemText, 'stem-cell');
            updateCell('dayStem', dayStemText, 'stem-cell');
            updateCell('hourStem', hourStemText, 'stem-cell');
            
            updateCell('yearBranch', yearBranchText, 'branch-cell');
            updateCell('monthBranch', monthBranchText, 'branch-cell');
            updateCell('dayBranch', dayBranchText, 'branch-cell');
            updateCell('hourBranch', hourBranchText, 'branch-cell');
            
            document.getElementById('selectedDate').textContent = 
                `${year}/${month}/${day}` + (timeInput ? ` ${hour}:${timeValue.split(':')[1] || '00'}` : ' (No time entered)');
            
            console.log(`Í≥ÑÏÇ∞ ÏôÑÎ£å: ${dayStemText} ${dayBranchText}ÏùºÏ£º, ${monthStemText} ${monthBranchText}ÏõîÏ£º`);
            
            if (genderInput) {
                calculateAndDisplayFortune(selectedDate, genderInput, yearGan, monthGan, monthZhi);
                document.getElementById('fortuneCard').style.display = 'block';
            } else {
                document.getElementById('fortuneCard').style.display = 'none';
            }
            
            calculateAndDisplayYearlyFortune();
            
            document.getElementById('resultSection').style.display = 'block';
            document.getElementById('inseongSection').style.display = 'block';
            
            window.currentPillars = {
                day: dayStemText,
                year: yearStemText + yearBranchText,
                month: monthStemText + monthBranchText
            };
        } monthNumber = getSolarMonth(selectedDate);
            if (monthNumber === null) {
                alert(`‚ùå ${year}ÎÖÑ ${month}Ïõî ${day}ÏùºÏùò Ï†àÏûÖÏãúÍ∞Ñ Í≥ÑÏÇ∞Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§!\n\nÏ†ïÌôïÌïú ÏõîÏ£º Í≥ÑÏÇ∞ÏùÑ ÏúÑÌï¥ Ï†àÏûÖÏãúÍ∞Ñ Îç∞Ïù¥ÌÑ∞Î•º ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.`);
                return;
            }
            
            const yearGanMod5 = yearGan % 5;
            let monthGanBase;
            switch(yearGanMod5) {
                case 0: case 5: monthGanBase = 2; break;
                case 1: case 6: monthGanBase = 4; break;
                case 2: case 7: monthGanBase = 6; break;
                case 3: case 8: monthGanBase = 8; break;
                case 4: case 9: monthGanBase = 0; break;
            }
            
            const monthGan = normalizeIndex(monthGanBase + (monthNumber - 1), 10);
            const monthZhi = normalizeIndex(2 + (monthNumber - 1), 12);
            
            let hourGan = null, hourZhi = null;
            if (timeInput) {
                let hourIndex = Math.floor((hour + 1) / 2) % 12;
                if (hour === 23) hourIndex = 0;
                
                const hourGanBase = (dayGan % 5) * 2;
                hourGan = normalizeIndex(hourGanBase + hourIndex, 10);
                hourZhi = hourIndex;
            }
            
            const yearStemText = tianGanEn[yearGan];
            const yearBranchText = diZhiEn[yearZhi];
            const monthStemText = tianGanEn[monthGan];
            const monthBranchText = diZhiEn[monthZhi];
            const dayStemText = tianGanEn[dayGan];
            const dayBranchText = diZhiEn[dayZhi];
            
            let hourStemText = '', hourBranchText = '';
            if (timeInput && hourGan !== null && hourZhi !== null) {
                hourStemText = tianGanEn[hourGan];
                hourBranchText = diZhiEn[hourZhi];
            }
            
            updateCell('yearStem', yearStemText, 'stem-cell');
            updateCell('monthStem', monthStemText, 'stem-cell');
            updateCell('dayStem', dayStemText, 'stem-cell');
            updateCell('hourStem', hourStemText, 'stem-cell');
            
            updateCell('yearBranch', yearBranchText, 'branch-cell');
            updateCell('monthBranch', monthBranchText, 'branch-cell');
            updateCell('dayBranch', dayBranchText, 'branch-cell');
            updateCell('hourBranch', hourBranchText, 'branch-cell');
            
            document.getElementById('selectedDate').textContent = 
                `${year}/${month}/${day}` + (timeInput ? ` ${hour}:${timeValue.split(':')[1] || '00'}` : ' (No time entered)');
            
            if (genderInput) {
                calculateAndDisplayFortune(selectedDate, genderInput, yearGan, monthGan, monthZhi);
                document.getElementById('fortuneCard').style.display = 'block';
            } else {
                document.getElementById('fortuneCard').style.display = 'none';
            }
            
            calculateAndDisplayYearlyFortune();
            
            document.getElementById('resultSection').style.display = 'block';
            document.getElementById('inseongSection').style.display = 'block';
            
            window.currentPillars = {
                day: dayStemText,
                year: yearStemText + yearBranchText,
                month: monthStemText + monthBranchText
            };
        }

        function updateCell(elementId, text, cellType) {
            const element = document.getElementById(elementId);
            element.textContent = text || '-';
            
            if (text && wuxing[text]) {
                element.className = `grid-cell ${cellType} ${elementClass[wuxing[text]]}`;
            } else {
                element.className = `grid-cell ${cellType}`;
                if (!text) {
                    element.style.border = '2px dashed rgba(255,255,255,0.5)';
                    element.style.background = 'transparent';
                }
            }
        }

        function displayAdditionalInfo() {
            // ÏÇ≠Ï†úÎêú Ìï®Ïàò
        }

        function calculateAndDisplayFortune(birthDate, gender, yearGan, monthGan, monthZhi) {
            const birthYear = birthDate.getFullYear();
            const currentYear = new Date().getFullYear();
            
            const isYangYear = yearGan % 2 === 0;
            const isForward = (gender === 'male' && isYangYear) || (gender === 'female' && !isYangYear);
            
            const fortuneStartAge = 3;
            const fortuneStartYear = birthYear + fortuneStartAge;
            const currentFortuneIndex = Math.floor((currentYear - fortuneStartYear) / 10);
            
            const fortunes = [];
            for (let i = -1; i <= 1; i++) {
                const fortuneIndex = currentFortuneIndex + i;
                const startYear = fortuneStartYear + (fortuneIndex * 10);
                const endYear = startYear + 9;
                
                let fortuneGan, fortuneZhi;
                if (isForward) {
                    fortuneGan = normalizeIndex(monthGan + fortuneIndex + 1, 10);
                    fortuneZhi = normalizeIndex(monthZhi + fortuneIndex + 1, 12);
                } else {
                    fortuneGan = normalizeIndex(monthGan - fortuneIndex - 1, 10);
                    fortuneZhi = normalizeIndex(monthZhi - fortuneIndex - 1, 12);
                }
                
                const fortuneType = i === -1 ? 'past' : (i === 0 ? 'current' : 'future');
                const fortuneLabel = i === -1 ? 'Previous' : (i === 0 ? 'Current' : 'Next');
                
                fortunes.push({
                    type: fortuneType,
                    label: fortuneLabel,
                    startYear,
                    endYear,
                    gan: fortuneGan,
                    zhi: fortuneZhi
                });
            }
            
            const directionText = isForward ? 'Forward' : 'Backward';
            const genderYearText = `${gender === 'male' ? 'Male' : 'Female'}, ${isYangYear ? 'Yang' : 'Yin'} year`;
            
            let fortuneHtml = `<div style="font-size: 0.9em; margin-bottom: 10px; opacity: 0.8;">
                ${genderYearText} ‚Üí ${directionText}<br>
                Fortune starts: Year ${fortuneStartYear} (Age ${fortuneStartAge})
            </div>`;
            
            fortunes.forEach(fortune => {
                const ganText = tianGanEn[fortune.gan];
                const zhiText = diZhiEn[fortune.zhi];
                const ganElement = wuxing[ganText];
                const zhiElement = wuxing[zhiText];
                
                fortuneHtml += `
                    <div class="fortune-period fortune-${fortune.type}">
                        <div class="fortune-title">${fortune.label} Fortune</div>
                        <div>${fortune.startYear} - ${fortune.endYear}</div>
                        <div class="fortune-elements">
                            <span class="fortune-element ${elementClass[ganElement]}">${ganText}</span>
                            <span class="fortune-element ${elementClass[zhiElement]}">${zhiText}</span>
                        </div>
                    </div>
                `;
            });
            
            document.getElementById('fortuneInfo').innerHTML = fortuneHtml;
        }

        function calculateAndDisplayYearlyFortune() {
            const now = new Date();
            const currentYear = now.getFullYear();
            
            const years = [currentYear - 1, currentYear, currentYear + 1];
            const yearLabels = ['Last Year', 'This Year', 'Next Year'];
            const yearTypes = ['past', 'current', 'future'];
            
            const base2025Gan = 1;
            const base2025Zhi = 5;
            
            let yearlyHtml = '';
            
            years.forEach((year, index) => {
                const yearOffset = year - 2025;
                const yearGan = normalizeIndex(base2025Gan + yearOffset, 10);
                const yearZhi = normalizeIndex(base2025Zhi + yearOffset, 12);
                
                const ganText = tianGanEn[yearGan];
                const zhiText = diZhiEn[yearZhi];
                const ganElement = wuxing[ganText];
                const zhiElement = wuxing[zhiText];
                
                yearlyHtml += `
                    <div class="fortune-period fortune-${yearTypes[index]}">
                        <div class="fortune-title">${yearLabels[index]}</div>
                        <div>${year}</div>
                        <div class="fortune-elements">
                            <span class="fortune-element ${elementClass[ganElement]}">${ganText}</span>
                            <span class="fortune-element ${elementClass[zhiElement]}">${zhiText}</span>
                        </div>
                    </div>
                `;
            });
            
            document.getElementById('yearlyInfo').innerHTML = yearlyHtml;
        }

        window.onload = async function() {
            const loadSuccess = await loadSolarTermsData();
            
            if (!loadSuccess) {
                // JSON ÌååÏùº Î°úÎìú Ïã§Ìå®Ïãú Í≤ΩÍ≥† ÌëúÏãú
                const errorDiv = document.createElement('div');
                errorDiv.className = 'error';
                errorDiv.style.cssText = 'background: #ffe6e6; color: #d8000c; padding: 15px; border-radius: 8px; margin: 10px 0; border-left: 4px solid #d8000c; font-weight: bold;';
                errorDiv.innerHTML = '‚ö†Ô∏è <strong>Ï†àÏûÖÏãúÍ∞Ñ Îç∞Ïù¥ÌÑ∞ ÌååÏùºÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§!</strong><br><br>' +
                                   'Ï†ïÌôïÌïú ÎßåÏÑ∏Î†• Í≥ÑÏÇ∞ÏùÑ ÏúÑÌï¥ÏÑúÎäî <code>solar_terms.json</code> ÌååÏùºÏù¥ ÌïÑÏöîÌï©ÎãàÎã§.<br>' +
                                   'Ïù¥ ÌååÏùº ÏóÜÏù¥Îäî ÏÇ¨Ï£º Í≥ÑÏÇ∞Ïù¥ Î∂àÍ∞ÄÎä•Ìï©ÎãàÎã§.<br><br>' +
                                   '<small>* Ï†àÏûÖÏãúÍ∞Ñ: ÏûÖÏ∂ò, Í≤ΩÏπ©, Ï≤≠Î™Ö Îì± 24Ï†àÍ∏∞Ïùò Ï†ïÌôïÌïú ÏãúÍ∞Å Ï†ïÎ≥¥</small>';
                document.querySelector('.container').insertBefore(errorDiv, document.querySelector('.input-section'));
                
                // Calculate Î≤ÑÌäº ÎπÑÌôúÏÑ±Ìôî
                const calculateBtn = document.querySelector('.search-btn');
                calculateBtn.disabled = true;
                calculateBtn.style.opacity = '0.5';
                calculateBtn.style.cursor = 'not-allowed';
                calculateBtn.textContent = 'Data Required';
            }
            
            const daySelect = document.getElementById('dayInput');
            daySelect.innerHTML = '<option value="">Day</option>';
            for (let i = 1; i <= 31; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = i;
                if (i === 10) option.selected = true;
                daySelect.appendChild(option);
            }
            
            const monthSelect = document.getElementById('monthInput');
            monthSelect.innerHTML = '<option value="">Month</option>';
            const months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
            for (let i = 1; i <= 12; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = months[i-1];
                if (i === 6) option.selected = true;
                monthSelect.appendChild(option);
            }
            
            const yearSelect = document.getElementById('yearInput');
            yearSelect.innerHTML = '<option value="">Year</option>';
            for (let i = 2026; i >= 1939; i--) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = i;
                if (i === 2025) option.selected = true;
                yearSelect.appendChild(option);
            }
        };
    </script>
</body>
</html>